<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>Ventas de Marcianos</title>
    <link rel="icon" type="image/png" href="logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #fff3e0, #fce4ec);
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 1100px;
            margin: auto;
        }

        h1 {
            text-align: center;
            color: #d84315;
            margin-bottom: 10px;
        }

        h2 {
            color: #bf360c;
            margin-top: 40px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }

        th {
            background: #ff7043;
            color: white;
            padding: 12px;
            font-weight: 600;
        }

        td {
            border-bottom: 1px solid #eee;
            padding: 10px;
        }

        th,
        td {
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
        }


        tr:hover {
            background: #fff3e0;
        }

        .agotado {
            color: #d32f2f;
            font-weight: bold;
        }

        .estado-pendiente {
            color: #d32f2f;
            font-weight: bold;
        }

        .estado-entregado {
            color: #2e7d32;
            font-weight: bold;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: #777;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 id="titulo">Cargando fecha...</h1>

        <h2>Lista de Marcianos</h2>
        <table id="tablaMarcianos">
            <thead>
                <tr>
                    <th>Marciano</th>
                    <th>Precio</th> 
                    <th>Disponible</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <h2>Clientes</h2>
        <table id="tablaClientes">
            <thead>
                <tr id="encabezadoClientes">
                    <th>Cliente</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <script>
            // ================= CONFIGURACIÓN =================
            const SHEET_ID = "1qprfPyUPduxJQmycbfrDwvnw2ushym9676ioKisuKiw";
            const API_KEY = "AIzaSyCAYZCXqU1uYoBN-WD64XFzycTHHnahPAU";

            const hojaMarcianos = "Marcianos";
            const hojaClientes = "Clientes";
            const hojaConfig = "Config";
            // ================================================

            async function leerHoja(nombreHoja) {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${nombreHoja}!A:Z?key=${API_KEY}`;
                const res = await fetch(url);
                const data = await res.json();
                return data.values;
            }

            async function cargarTitulo() {
                const data = await leerHoja(hojaConfig);

                if (data && data.length > 1 && data[1][0]) {
                    document.getElementById("titulo").innerText = data[1][0];
                } else {
                    document.getElementById("titulo").innerText = "Ventas de Marcianos";
                }
            }


            async function cargarMarcianos() {
                const data = await leerHoja(hojaMarcianos);
                const tbody = document.querySelector("#tablaMarcianos tbody");
                tbody.innerHTML = "";

                for (let i = 1; i < data.length; i++) {
                    const [nombre, precio, inicial, Disponible] = data[i];
                    const tr = document.createElement("tr");

                    tr.innerHTML = `
      <td>${nombre}</td>
      <td>S/ ${precio}</td>
      <td class="${Disponible == 0 ? 'agotado' : ''}">${Disponible == 0 ? 'AGOTADO' : Disponible}</td>
    `;
                    tbody.appendChild(tr);
                }
            }

            async function cargarClientes() {
                const data = await leerHoja(hojaClientes);
                const thead = document.getElementById("encabezadoClientes");
                const tbody = document.querySelector("#tablaClientes tbody");

                thead.innerHTML = "<th>Cliente</th>";
                tbody.innerHTML = "";

                // Encabezados dinámicos
                for (let i = 1; i < data[0].length; i++) {
                    const th = document.createElement("th");
                    th.innerText = data[0][i];
                    thead.appendChild(th);
                }

                // Filas
                for (let i = 1; i < data.length; i++) {
                    const tr = document.createElement("tr");
                    data[i].forEach(celda => {
                        const td = document.createElement("td");
                        td.innerText = celda;

                        if (celda) {
                            const texto = celda.toString().toLowerCase();

                            if (texto === "pendiente") {
                                td.classList.add("estado-pendiente");
                            } else if (texto === "entregado") {
                                td.classList.add("estado-entregado");
                            }
                        }

                        tr.appendChild(td);
                    });

                    tbody.appendChild(tr);
                }
            }

            async function iniciar() {
                await cargarTitulo();
                await cargarMarcianos();
                await cargarClientes();
            }

            iniciar();
        </script>
    </div>
</body>


</html>
